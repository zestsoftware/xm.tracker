<div class="task"
     tal:define="task nocall:view/task"
     tal:condition="task"
     tal:attributes="id string:task-${task/uid}"
     i18n:domain="tracker">

  <hr />

  <h2 class="task-time" tal:content="view/total_time" />

  <h2 tal:define="title string:${task/project} | ${task/story};
                  title python:not task.is_unassigned() and title or '';"
      tal:attributes="class string:task-title kssattr-tasktitle-taskdetails-${task/uid};
                      title title;">
    <tal:down tal:condition="not: task/is_unassigned">
      [&darr;]
    </tal:down>
    <tal:title tal:content="task/title"/>
  </h2>

  <div class="discreet"
       tal:condition="view/remaining_time">
    <span i18n:translate="remaining">
      Remaining:
    </span>
    <span tal:content="view/remaining_time">1:23</span>
  </div>

  <form
      method="post"
      class="track-form"
      tal:define="disabled python:not view.tracker_has_started() and 'disabled' or '';"
      action="@@track_time">
    <div>
      <input type="hidden"
             name="uid"
             tal:attributes="value task/uid" />
      <input type="text"
             name="text"
             tabindex="1"
             size="60" />
      <input type="submit"
             name="track"
             tal:attributes="class string:track-time kssattr-uid-${task/uid};
                             disabled disabled;"
             i18n:attributes="value track_button"
             value="Track" />
    </div>
  </form>
  <div class="hidden"
       tal:attributes="id string:taskdetails-${task/uid};
                       class python:not task.is_unassigned() and 'hidden' or '';">

    <tal:block replace="structure provider:xm.tracker.entries" />

    <tal:book condition="python:view.entries and not task.is_unassigned()">
      <form
          method="post"
          action="@@tracker_book">
        <div>
          <input type="hidden"
                 name="uid"
                 tal:attributes="value task/uid" />
          <input type="submit"
                 name="book"
                 class="book-time"
                 value="Book"
                 i18n:attributes="value label_book" />
          <input type="submit"
                 name="book_and_close"
                 class="book-time"
                 value="Book and close"
                 i18n:attributes="value label_close" />
        </div>
      </form>
    </tal:book>
  </div>
</div>
