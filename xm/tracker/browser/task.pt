<div class="task"
     tal:define="task nocall:view/task"
     tal:condition="task"
     tal:attributes="id string:task-${task/uid}"
     i18n:domain="tracker">

  <hr />
  <h2 style="float:right" tal:content="view/total_time" />
  <h2 tal:content="task/title"
      tal:attributes="class string:task-title kssattr-tasktitle-taskdetails-${task/uid}" />
  <form
      method="post"
      class="track_form"
      tal:define="disabled python:not view.tracker_has_started() and 'disabled' or '';"
      action="@@track_time">
    <input type="hidden"
           name="uid"
           tal:attributes="value task/uid" />
    <input type="text"
           name="text"
           size="60" />
    <input type="submit"
           name="track"
           tal:attributes="class string:track-time kssattr-uid-${task/uid};
                           disabled disabled;"
           i18n:attributes="value track_button"
           value="Track" />
  </form>
  <div class="hidden"
       tal:attributes="id string:taskdetails-${task/uid};
                       class python:not task.is_unassigned() and 'hidden' or '';">
    <div class="storyline"
         tal:condition="task/project">
      <span tal:content="task/project" />
      | <span tal:content="task/story" />
    </div>
    
    <tal:block replace="structure provider:xm.tracker.entries" />
    
    <tal:book condition="python:view.entries and not task.is_unassigned()">
      <form
          method="post"
          action="@@tracker_book">
        <input type="hidden"
               name="uid"
               tal:attributes="value task/uid" />
        <input type="submit"
               name="book"
               class="book-time"
               value="Book"
               i18n:attributes="value label_book" />
        <input type="submit"
               name="book_and_close"
               class="book-time"
               value="Book and close"
               i18n:attributes="value label_close" />
      </form>
    </tal:book>
  </div>
</div>
